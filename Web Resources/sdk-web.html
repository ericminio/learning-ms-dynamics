<!DOCTYPE html>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>SDK</title>
        <style>
            label, button {
                display: block;
                margin-top: 10px;
            }
            .success {
                background-color: rgb(199, 228, 169);
                color: white;
            }
            .error {
                background-color: red;
                color: white;
            }
        </style>
        <script src="sdk.js" charset="utf-8"></script>
        <script>
            let executeQuery = async (document)=> {
                let entityNamePlural = document.querySelector('#entityNamePlural').value
                let method = document.querySelector('#method').value
                let data = JSON.parse(document.querySelector('#data').value)

                await execute({
                    method:method,
                    uri:`${window.location.origin}/api/data/v9.0/${entityNamePlural}`,
                    data:data
                }, document)
            }
            let executeDelete = async (document)=> {
                let entityNamePlural = document.querySelector('#entityNamePlural').value
                let id = document.querySelector('#id').value

                await execute({
                    method: 'DELETE',
                    uri:`${window.location.origin}/api/data/v9.0/${entityNamePlural}(${id})`
                }, document)
            }
            let execute = async (options, document)=> {
                let status = document.querySelector('#status')
                let message = document.querySelector('#message')
                try {
                    let result = await Sdk.request(options)
                    console.log('result', result);
                    status.innerHTML = 'success'
                    status.className = 'success'
                    message.innerHTML = `<pre>${JSON.stringify({ status:result.status, text:result.statusText}, null, 2)}</pre>`
                }
                catch (error) {
                    console.log('error', error);
                    status.innerHTML = error.message
                    status.className = 'error'
                    message.innerHTML = ''
                }
            }
        </script>
    </head>
    <body>
        <label>Entity name plural</label>
        <input id="entityNamePlural" value="accounts" />
        <hr/>

        <label>Method</label>
        <input id="method" value="POST" />
        <label>Query</label>
        <textarea id="data" rows="20" cols="80"></textarea>
        <button type="button" id="execute" onclick="executeQuery(document)">Send</button>
        <hr/>

        <label>id to be deleted</label>
        <input id="id" size="45"/>
        <button type="button" id="delete" onclick="executeDelete(document)">Delete</button>
        <hr/>

        <div id="status"></div>
        <div id="message"></div>

        <script type="text/javascript">
            let data = document.querySelector('#data')
            data.value = JSON.stringify({
                name: 'testing ' + new Date().getTime()
            }, null, 2)
        </script>

    </body>
</html>
